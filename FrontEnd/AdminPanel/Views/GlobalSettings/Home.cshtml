@model ICollection<IAUAdmin.DTO.Entity.RequestStatusDTO>
@{
	ViewBag.Title = "Edit Allowed Delay";
	ViewBag.pTitle = "Edit Allowed Delay";
	ViewBag.pageTitle = "Global Settings";
	ViewBag.arTitle = "تعديل الوقت المسموح للتاخير";
	ViewBag.arpTitle = "تعديل الوقت المسموح للتاخير";
	ViewBag.arpageTitle = "الإعدادات العامة";
	Layout = "~/Views/Shared/_Layout.cshtml";
}



<!-- select2 css -->
<link href="~/assets/libs/select2/css/select2.min.css" rel="stylesheet" type="text/css" />

<!-- dropzone css -->
<link href="~/assets/libs/dropzone/min/dropzone.min.css" rel="stylesheet" type="text/css" />
<style>
	span.select2 {
		width: 100% !important
	}

	label.control-label::after {
		content: ":";
	}

	label.control-label {
		font-weight: bold;
	}

	span.select2-selection.select2-selection--single {
		height: 36px !important;
	}

	.select2-selection__rendered, .select2-selection__arrow {
		margin-top: 3px;
		font-weight: normal;
	}
</style>
<div class="row">
	<div class="col-12">
		<div class="card">
			<div class="card-body">

				<h4 key="t-basicInfo" class="card-title">Basic Information</h4>
				<p key="t-fillrequired" class="card-title-desc">Fill all information below</p>

				<div class="row">
					@foreach (var i in Model)
					{
						<div class="col-xl-6 col-lg-6 col-md-6 col-12">
							<div class="form-group">
								<label class="control-label" for="name">@(Request.Cookies["lang"].Value == "ar" ? i.StateName_AR : i.StateName_EN)</label>
								@Html.TextBox("State-" + i.State_ID, i.AllowedDelay, new { @class = "form-control ar-font State-val", @type = "number" })
							</div>
						</div>
					}
					<button type="submit" key="t-save" id="SaveDataOFDelayed" class="btn btn-primary mr-1 waves-effect waves-light">Save Changes</button>
					@Html.ActionLink("Cancel", "Home", "Home", null, new { @type = "reset", @key = "t-cancel", @class = "btn btn-secondary waves-effect" })
				</div>

			</div>
		</div>

	</div>
</div>
<!-- end row -->
<!-- JAVASCRIPT -->
<script src="~/assets/libs/jquery/jquery.min.js"></script>
<script src="~/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="~/assets/libs/metismenu/metisMenu.min.js"></script>
<script src="~/assets/libs/simplebar/simplebar.min.js"></script>
<script src="~/assets/libs/node-waves/waves.min.js"></script>
<script src="~/assets/js/lang/jquery.multiLanguage.js"></script>

<!-- select 2 plugin -->
<script src="~/assets/libs/select2/js/select2.min.js"></script>

<!-- dropzone plugin -->
<script src="~/assets/libs/dropzone/min/dropzone.min.js"></script>

<!-- init js -->
<script src="~/assets/js/pages/ecommerce-select2.init.js"></script>

<!-- App js -->
<script src="~/assets/js/app.js"></script>
<script>
	$('#SaveDataOFDelayed').click(function () {
		let data = [];
		([...$('input.State-val')]).forEach(i => {
			let ref = $(i);
			data.push({ State_ID: ref.attr('name').split('-')[1], AllowedDelay: ref.val() })
		})
		let form = new FormData();
		form.append("data", JSON.stringify(data));
		console.log(data)
		$.ajax({
			url: "/GlobalSettings/SaveData", processData: false,
			contentType: false, enctype: 'multipart/form-data', data: form, type: "POST", success: function () {
				window.location.href = window.location.href
			}
		})
	})
</script>
